extends ../../layouts/default.pug
include ../../mixins/alert.pug

block main
  +alert-success(5000)
  +alert-error(5000)
  
  .container.my-5
    .row
      .col-12
        .card.shadow-sm.border-0.mb-4
          .card-header.text-white.py-3(style="background-color: #DB0E0E;")
            h4.mb-0.d-flex.align-items-center
              i.fa-solid.fa-credit-card.me-3
              | Thanh toán đơn hàng

          .card-body.p-4
            if(cartDetail.products.length > 0)
              h5.mb-3(style="color: #DB0E0E;") Thông tin đơn hàng
              .table-responsive
                table.table.table-hover.align-middle
                  thead.table-light
                    tr
                      th(width="8%") STT
                      th(width="15%") Hình ảnh
                      th(width="35%") Sản phẩm
                      th(width="15%") Đơn giá
                      th(width="12%") Số lượng
                      th(width="15%") Thành tiền
                  tbody
                    each item, index in cartDetail.products
                      tr
                        td.text-center.fw-bold #{index + 1}
                        td.text-center
                          img.rounded.shadow-sm(
                            src=item.productInfo.thumbnail,
                            alt=item.productInfo.title,
                            style="width: 60px; height: 60px; object-fit: cover;"
                          )
                        td
                          .d-flex.flex-column
                            span.fw-bold= item.productInfo.title
                            small.text-muted Mã SP: #{item.product_id.slice(-6).toUpperCase()}
                        td.text-end
                          span.fw-bold.text-primary #{item.productInfo.priceNew.toLocaleString('vi-VN')}$
                        td.text-center
                          span.badge.bg-light.text-dark #{item.quantity}
                        td.text-end
                          span.fw-bold.text-danger #{item.totalPrice.toLocaleString('vi-VN')} $

              hr.my-4
              
              .row
                .col-md-8
                .col-md-4
                  .card.border-0.bg-light
                    .card-body.text-center
                      h5.text-muted.mb-2 Tổng đơn hàng
                      h3.text-danger.fw-bold #{cartDetail.totalPrice.toLocaleString('vi-VN')} $

              hr.my-4

              .row
                .col-md-8
                  .card.shadow-sm.border-0
                    .card-header.bg-light.py-3
                      h5.mb-0(style="color: #DB0E0E;") Thông tin giao hàng
                    .card-body.p-4
                      form(action="/checkout/order", method="POST")
                        .row
                          .col-md-6
                            .form-group.mb-3
                              label.fw-bold.mb-2(for="fullName") 
                                i.fa-solid.fa-user.me-2(style="color: #DB0E0E;")
                                | Họ và tên *
                              input.form-control.p-3(
                                type="text"
                                id="fullName"
                                name="fullName"
                                placeholder="Nhập họ và tên đầy đủ"
                                required
                              )
                          
                          .col-md-6
                            .form-group.mb-3
                              label.fw-bold.mb-2(for="phone")
                                i.fa-solid.fa-phone.me-2(style="color: #DB0E0E;")
                                | Số điện thoại *
                              input.form-control.p-3(
                                type="tel"
                                id="phone"
                                name="phone"
                                placeholder="Nhập số điện thoại"
                                required
                              )
                        
                        .form-group.mb-4
                          label.fw-bold.mb-2(for="address")
                            i.fa-solid.fa-map-marker-alt.me-2(style="color: #DB0E0E;")
                            | Địa chỉ giao hàng *
                          textarea.form-control.p-3(
                            id="address"
                            name="address"
                            rows="3"
                            placeholder="Nhập địa chỉ chi tiết (số nhà, tên đường, phường/xã, quận/huyện, tỉnh/thành)"
                            required
                          )

                        .d-grid
                          button.btn.text-white.py-3(
                            type="submit"
                            style="background-color: #DB0E0E; border-color: #DB0E0E; font-size: 16px;"
                          )
                            i.fa-solid.fa-shopping-cart.me-2
                            | ĐẶT HÀNG NGAY

                .col-md-4
                  .card.shadow-sm.border-0
                    .card-header.bg-light.py-3
                      h5.mb-0(style="color: #DB0E0E;") Chính sách
                    .card-body
                      .policy-item.mb-3
                        .d-flex.align-items-center
                          i.fa-solid.fa-truck.fa-2x.text-success.me-3
                          .policy-content
                            h6.mb-1.text-success Miễn phí vận chuyển
                            small.text-muted Đơn hàng từ 500$
                      
                      .policy-item.mb-3
                        .d-flex.align-items-center
                          i.fa-solid.fa-shield-alt.fa-2x.text-primary.me-3
                          .policy-content
                            h6.mb-1.text-primary Bảo hành chính hãng
                            small.text-muted 12 tháng toàn quốc
                      
                      .policy-item.mb-3
                        .d-flex.align-items-center
                          i.fa-solid.fa-undo.fa-2x.text-info.me-3
                          .policy-content
                            h6.mb-1.text-info Đổi trả dễ dàng
                            small.text-muted Trong vòng 7 ngày
                      
                      .policy-item
                        .d-flex.align-items-center
                          i.fa-solid.fa-headset.fa-2x.text-warning.me-3
                          .policy-content
                            h6.mb-1.text-warning Hỗ trợ 24/7
                            small.text-muted Tư vấn nhiệt tình

            else
              .text-center.py-5
                i.fa-solid.fa-shopping-cart.fa-4x.text-muted.mb-3
                h4.text-muted Giỏ hàng trống
                p.text-muted.mb-4 Bạn chưa có sản phẩm nào để thanh toán
                a.btn.text-white.px-4.py-2(
                  href="/products"
                  style="background-color: #DB0E0E; border-color: #DB0E0E;"
                )
                  i.fa-solid.fa-shopping-bag.me-2
                  | Tiếp tục mua sắm

    .row.mt-3
      .col-12.text-center
        a.btn.btn-outline-secondary.px-4(href="/cart")
          i.fa-solid.fa-arrow-left.me-2
          | Quay lại giỏ hàng